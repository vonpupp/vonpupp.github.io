{"author":{"name":"Albert","type":"card","url":"https://albertdelafuente.com"},"content":{"html":"\n\n\u003cp\u003eOn this post I will show how to configure and use \u003ccode\u003ePacserve\u003c/code\u003e and \u003ccode\u003ePowerpill\u003c/code\u003e on\nArch Linux. On a network of several Arch Linux boxes, it is possible to\nconfigure a \u003ccode\u003eMaster\u003c/code\u003e server which will hold a copy of all the installed packages\nwithin that host and keep it up to date frequently.  The other hosts on the\nnetwork can be configured as \u003ccode\u003eSlaves\u003c/code\u003e and they will download the packages from\nthe Master whenever possible instead of the Internet directly. The objective is\nto save bandwidth and time when using the package manager.\u003c/p\u003e\n\n\u003ch2 id=\"configuring-pacserve-and-powerpill-on-arch-linux\"\u003eConfiguring Pacserve and Powerpill on Arch Linux\u003c/h2\u003e\n\n\u003cp\u003eThe documentation of \u003ca href=\"https://xyne.dev/projects/pacserve/\"\u003ePacserve\u003c/a\u003e explains how it works. This image summarizes\nwell the behavior.\u003c/p\u003e\n\n\n\n\n\u003cfigure\u003e\n    \n        \u003cimg src=\"https://albertdelafuente.com/ox-hugo/Pacserve_Request_Flow_Chart.svg\"/\u003e \u003c/figure\u003e\n\n\n\u003cp\u003ePacserve by itself seems very interesting however I could not make it work\nproperly. I think it has something to do my router UDP multicast forwarding\nsupport (see \u003ca href=\"http://wiki.openwrt.org/doc/recipes/dumbap\u0026gt;\"\u003eopenwrt-multicast\u003c/a\u003e). Nevertheless, I could use it within\n\u003ca href=\"http://xyne.archlinux.ca/projects/powerpill/\u0026gt;\"\u003ePowerpill\u003c/a\u003e which is a pacman wrapper to allow parallel and segmented downloads\nthrough \u003ca href=\"http://aria2.sourceforge.net/\u0026gt;\"\u003eAria2\u003c/a\u003e and \u003ca href=\"http://xyne.archlinux.ca/projects/reflector/\u0026gt;\"\u003eReflector\u003c/a\u003e.  This combo sounds even better, so I will focus on\nhow to install and use the tree tools together.\u003c/p\u003e\n\n\u003ch3 id=\"installation\"\u003eInstallation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"c1\"\u003e# Just in case the testdb does not exists\u003c/span\u003e\ngpg --list-key\n\n\u003cspan class=\"c1\"\u003e# Receive xyne gpg key\u003c/span\u003e\ngpg --recv-keys 1D1F0DC78F173680\n\n\u003cspan class=\"c1\"\u003e# Install the packages\u003c/span\u003e\nyaourt -Sy --noconfirm reflector pacserve powerpill\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"starting-the-services--both-the-master-and-slaves--host--s\"\u003eStarting the services (both the Master and Slave(s) host(s))\u003c/h3\u003e\n\n\u003cp\u003eAfter everything is installed:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"c1\"\u003e# Enable opening the ports\u003c/span\u003e\nsudo systemctl \u003cspan class=\"nb\"\u003eenable\u003c/span\u003e pacserve-ports.service\n\n\u003cspan class=\"c1\"\u003e# Enable pacserve\u003c/span\u003e\nsudo systemctl \u003cspan class=\"nb\"\u003eenable\u003c/span\u003e pacserve.service\n\n\u003cspan class=\"c1\"\u003e# Start pacserve\u003c/span\u003e\nsudo systemctl start pacserve.service\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor troubleshooting purposes the services can be started manually. See the\nTroubleshooting section if you have problems.\u003c/p\u003e\n\n\u003ch3 id=\"configuring-powerpill-to-use-the-master-server--slaves--hosts-only\"\u003eConfiguring Powerpill to use the Master server (Slave(s) hosts only)\u003c/h3\u003e\n\n\u003cp\u003eEdit the file \u003ccode\u003e/etc/powerpill/powerpill.json\u003c/code\u003e to include the `pacserve`.`serve`\nattribute:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026#34;aria2\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;args\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--allow-overwrite=true\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--always-resume=false\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--auto-file-renaming=false\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--check-integrity=true\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--conditional-get=true\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--continue=true\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--file-allocation=none\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--log-level=error\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--max-concurrent-downloads=100\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--max-connection-per-server=5\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--min-split-size=5M\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--remote-time=true\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--show-console-readout=true\u0026#34;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;path\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;/usr/bin/aria2c\u0026#34;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026#34;pacman\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;config\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;/etc/pacman.conf\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;path\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;/usr/bin/pacman\u0026#34;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026#34;pacserve\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;server\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;http://192.168.56.6:15678\u0026#34;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026#34;powerpill\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;ask\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;reflect databases\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026#34;reflector\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;args.unused\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--protocol\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;http\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--latest\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;50\u0026#34;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026#34;rsync\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;args\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--no-motd\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;--progress\u0026#34;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;db only\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;path\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;/usr/bin/rsync\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026#34;servers\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn this example I configured two VMs using Vagrant with an internal network.\nThe server runs on \u003ccode\u003e192.168.56.6\u003c/code\u003e on port `15678` (default port).\u003c/p\u003e\n\n\u003cp\u003eAfter this we can use Powerpill as a replacement of Pacman as follows\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"c1\"\u003e# System upgrade\u003c/span\u003e\nsudo powerpill -Syu\n\n\u003cspan class=\"c1\"\u003e# Install a package\u003c/span\u003e\nsudo powerpill -S wget\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"conclusions\"\u003eConclusions\u003c/h3\u003e\n\n\u003cp\u003eWhen \u003ca href=\"http://xyne.archlinux.ca/projects/powerpill/\u0026gt;\"\u003epowerpill\u003c/a\u003e is used..\u003c/p\u003e\n\n\u003ch3 id=\"todos\"\u003eTODOs\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eCheck how to have only *\u003cstrong\u003e\u003cem\u003eone\u003c/em\u003e\u003c/strong\u003e* Master DB and all the Slaves also sync the DB from the master\u003c/li\u003e\n\u003cli\u003eUse reflector commands within Powerpill\u003c/li\u003e\n\u003cli\u003eWhat happens if different architectures are on the same network and UDP multicast works?\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"troubleshooting-pacserve--without-powerpill\"\u003eTroubleshooting Pacserve (without Powerpill)\u003c/h3\u003e\n\n\u003cp\u003eAs I said before I could not make it working using multicast, so I had to\nmanually start the Pacserve Master host as:\u003c/p\u003e\n\n\u003cp\u003eInput:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003epacserve --multicast\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOutput:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003ePacserveServer\n  PID                  \u003cspan class=\"m\"\u003e1048\u003c/span\u003e\n  Addresses\n    lo:     \u003cspan class=\"m\"\u003e127\u003c/span\u003e.0.0.1\n    eth0:   \u003cspan class=\"m\"\u003e10\u003c/span\u003e.0.2.15\n    enp0s9: \u003cspan class=\"m\"\u003e192\u003c/span\u003e.168.56.6\n  Port                 \u003cspan class=\"m\"\u003e15678\u003c/span\u003e\n  Multicast Address    all interfaces\n  Multicast Port       \u003cspan class=\"m\"\u003e15679\u003c/span\u003e\n  Multicast Group      \u003cspan class=\"m\"\u003e224\u003c/span\u003e.3.45.67\n  Multicast Interval   5m\n  Multicast Interfaces all\n  Filelist             None\n  Filterlist           None\n  MOTD                 None\n  Upload Directory     None\n  Paths                None\n  Static Peers         None\n\nPress ctrl+C to exit.\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2015\u003c/span\u003e-10-23 \u003cspan class=\"m\"\u003e05\u003c/span\u003e:54:54 AEDT\u003cspan class=\"o\"\u003e]\u003c/span\u003e INFO: announcing presence by multicast \u003cspan class=\"o\"\u003e(\u003c/span\u003egroup: \u003cspan class=\"m\"\u003e224\u003c/span\u003e.3.45.67\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2015\u003c/span\u003e-10-23 \u003cspan class=\"m\"\u003e05\u003c/span\u003e:54:54 AEDT\u003cspan class=\"o\"\u003e]\u003c/span\u003e INFO: announcement sent via all interfaces\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAssuming the server is running with the IP \u003ccode\u003e192.168.56.6\u003c/code\u003e, you can manually\nstart Pacserve on the Slave(s) hosts as:\u003c/p\u003e\n\n\u003cp\u003eInput:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003epacserve --multicast --peer \u003cspan class=\"s2\"\u003e\u0026#34;http://192.168.56.6:15678\u0026#34;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOutput:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003ePacserveServer\n  PID                  \u003cspan class=\"m\"\u003e1102\u003c/span\u003e\n  Addresses\n    lo:     \u003cspan class=\"m\"\u003e127\u003c/span\u003e.0.0.1\n    eth0:   \u003cspan class=\"m\"\u003e10\u003c/span\u003e.0.2.15\n    enp0s9: \u003cspan class=\"m\"\u003e192\u003c/span\u003e.168.56.7\n  Port                 \u003cspan class=\"m\"\u003e15678\u003c/span\u003e\n  Multicast Address    all interfaces\n  Multicast Port       \u003cspan class=\"m\"\u003e15679\u003c/span\u003e\n  Multicast Group      \u003cspan class=\"m\"\u003e224\u003c/span\u003e.3.45.67\n  Multicast Interval   5m\n  Multicast Interfaces all\n  Filelist             None\n  Filterlist           None\n  MOTD                 None\n  Upload Directory     None\n  Paths                None\n  Static Peers         http://192.168.56.6:15678\n\nPress ctrl+C to exit.\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2015\u003c/span\u003e-10-23 \u003cspan class=\"m\"\u003e05\u003c/span\u003e:56:00 AEDT\u003cspan class=\"o\"\u003e]\u003c/span\u003e INFO: announcing presence via POST to http://192.168.56.6:15678\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2015\u003c/span\u003e-10-23 \u003cspan class=\"m\"\u003e05\u003c/span\u003e:56:00 AEDT\u003cspan class=\"o\"\u003e]\u003c/span\u003e INFO: POSTing to http://192.168.56.6:15678/ \u003cspan class=\"o\"\u003e[\u003c/span\u003etype: nudge\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2015\u003c/span\u003e-10-23 \u003cspan class=\"m\"\u003e05\u003c/span\u003e:56:01 AEDT\u003cspan class=\"o\"\u003e]\u003c/span\u003e INFO: announcing presence by multicast \u003cspan class=\"o\"\u003e(\u003c/span\u003egroup: \u003cspan class=\"m\"\u003e224\u003c/span\u003e.3.45.67\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2015\u003c/span\u003e-10-23 \u003cspan class=\"m\"\u003e05\u003c/span\u003e:56:01 AEDT\u003cspan class=\"o\"\u003e]\u003c/span\u003e INFO: announcement sent via all interfaces\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter starting the Slave host you should get the following message on the Master console:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2015\u003c/span\u003e-10-23 \u003cspan class=\"m\"\u003e05\u003c/span\u003e:56:00 AEDT\u003cspan class=\"o\"\u003e]\u003c/span\u003e INFO: added http://192.168.56.7:15678/ \u003cspan class=\"o\"\u003e(\u003c/span\u003ePOST\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2015\u003c/span\u003e-10-23 \u003cspan class=\"m\"\u003e05\u003c/span\u003e:56:00 AEDT\u003cspan class=\"o\"\u003e]\u003c/span\u003e INFO: \u003cspan class=\"m\"\u003e192\u003c/span\u003e.168.56.7 \u003cspan class=\"s2\"\u003e\u0026#34;POST / HTTP/1.1\u0026#34;\u003c/span\u003e \u003cspan class=\"m\"\u003e200\u003c/span\u003e -\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","text":" On this post I will show how to configure and use Pacserve and Powerpill on Arch Linux. On a network of several Arch Linux boxes, it is possible to configure a Master server which will hold a copy of all the installed packages within that host and keep it up to date frequently. The other hosts on the network can be configured as Slaves and they will download the packages from the Master whenever possible instead of the Internet directly. The objective is to save bandwidth and time when using the package manager.\nConfiguring Pacserve and Powerpill on Arch Linux The documentation of Pacserve explains how it works. This image summarizes well the behavior.\n  Pacserve by itself seems very interesting however I could not make it work properly. I think it has something to do my router UDP multicast forwarding support (see openwrt-multicast). Nevertheless, I could use it within Powerpill which is a pacman wrapper to allow parallel and segmented downloads through Aria2 and Reflector. This combo sounds even better, so I will focus on how to install and use the tree tools together.\nInstallation # Just in case the testdb does not exists gpg --list-key # Receive xyne gpg key gpg --recv-keys 1D1F0DC78F173680 # Install the packages yaourt -Sy --noconfirm reflector pacserve powerpill Starting the services (both the Master and Slave(s) host(s)) After everything is installed:\n# Enable opening the ports sudo systemctl enable pacserve-ports.service # Enable pacserve sudo systemctl enable pacserve.service # Start pacserve sudo systemctl start pacserve.service For troubleshooting purposes the services can be started manually. See the Troubleshooting section if you have problems.\nConfiguring Powerpill to use the Master server (Slave(s) hosts only) Edit the file /etc/powerpill/powerpill.json to include the `pacserve`.`serve` attribute:\n{ \u0026#34;aria2\u0026#34;: { \u0026#34;args\u0026#34;: [ \u0026#34;--allow-overwrite=true\u0026#34;, \u0026#34;--always-resume=false\u0026#34;, \u0026#34;--auto-file-renaming=false\u0026#34;, \u0026#34;--check-integrity=true\u0026#34;, \u0026#34;--conditional-get=true\u0026#34;, \u0026#34;--continue=true\u0026#34;, \u0026#34;--file-allocation=none\u0026#34;, \u0026#34;--log-level=error\u0026#34;, \u0026#34;--max-concurrent-downloads=100\u0026#34;, \u0026#34;--max-connection-per-server=5\u0026#34;, \u0026#34;--min-split-size=5M\u0026#34;, \u0026#34;--remote-time=true\u0026#34;, \u0026#34;--show-console-readout=true\u0026#34; ], \u0026#34;path\u0026#34;: \u0026#34;/usr/bin/aria2c\u0026#34; }, \u0026#34;pacman\u0026#34;: { \u0026#34;config\u0026#34;: \u0026#34;/etc/pacman.conf\u0026#34;, \u0026#34;path\u0026#34;: \u0026#34;/usr/bin/pacman\u0026#34; }, \u0026#34;pacserve\u0026#34;: { \u0026#34;server\u0026#34;: \u0026#34;http://192.168.56.6:15678\u0026#34; }, \u0026#34;powerpill\u0026#34;: { \u0026#34;ask\u0026#34;: true, \u0026#34;reflect databases\u0026#34;: false }, \u0026#34;reflector\u0026#34;: { \u0026#34;args.unused\u0026#34;: [ \u0026#34;--protocol\u0026#34;, \u0026#34;http\u0026#34;, \u0026#34;--latest\u0026#34;, \u0026#34;50\u0026#34; ] }, \u0026#34;rsync\u0026#34;: { \u0026#34;args\u0026#34;: [ \u0026#34;--no-motd\u0026#34;, \u0026#34;--progress\u0026#34; ], \u0026#34;db only\u0026#34;: true, \u0026#34;path\u0026#34;: \u0026#34;/usr/bin/rsync\u0026#34;, \u0026#34;servers\u0026#34;: [] } } In this example I configured two VMs using Vagrant with an internal network. The server runs on 192.168.56.6 on port `15678` (default port).\nAfter this we can use Powerpill as a replacement of Pacman as follows\n# System upgrade sudo powerpill -Syu # Install a package sudo powerpill -S wget Conclusions When powerpill is used..\nTODOs  Check how to have only *one* Master DB and all the Slaves also sync the DB from the master Use reflector commands within Powerpill What happens if different architectures are on the same network and UDP multicast works?  Troubleshooting Pacserve (without Powerpill) As I said before I could not make it working using multicast, so I had to manually start the Pacserve Master host as:\nInput:\npacserve --multicast Output:\nPacserveServer PID 1048 Addresses lo: 127.0.0.1 eth0: 10.0.2.15 enp0s9: 192.168.56.6 Port 15678 Multicast Address all interfaces Multicast Port 15679 Multicast Group 224.3.45.67 Multicast Interval 5m Multicast Interfaces all Filelist None Filterlist None MOTD None Upload Directory None Paths None Static Peers None Press ctrl+C to exit. [2015-10-23 05:54:54 AEDT] INFO: announcing presence by multicast (group: 224.3.45.67) [2015-10-23 05:54:54 AEDT] INFO: announcement sent via all interfaces Assuming the server is running with the IP 192.168.56.6, you can manually start Pacserve on the Slave(s) hosts as:\nInput:\npacserve --multicast --peer \u0026#34;http://192.168.56.6:15678\u0026#34; Output:\nPacserveServer PID 1102 Addresses lo: 127.0.0.1 eth0: 10.0.2.15 enp0s9: 192.168.56.7 Port 15678 Multicast Address all interfaces Multicast Port 15679 Multicast Group 224.3.45.67 Multicast Interval 5m Multicast Interfaces all Filelist None Filterlist None MOTD None Upload Directory None Paths None Static Peers http://192.168.56.6:15678 Press ctrl+C to exit. [2015-10-23 05:56:00 AEDT] INFO: announcing presence via POST to http://192.168.56.6:15678 [2015-10-23 05:56:00 AEDT] INFO: POSTing to http://192.168.56.6:15678/ [type: nudge] [2015-10-23 05:56:01 AEDT] INFO: announcing presence by multicast (group: 224.3.45.67) [2015-10-23 05:56:01 AEDT] INFO: announcement sent via all interfaces After starting the Slave host you should get the following message on the Master console:\n[2015-10-23 05:56:00 AEDT] INFO: added http://192.168.56.7:15678/ (POST) [2015-10-23 05:56:00 AEDT] INFO: 192.168.56.7 \u0026#34;POST / HTTP/1.1\u0026#34; 200 -"},"name":"Configuring pacsrv and powerpill on Arch Linux","published":"2015-10-21T00:00:00-02:00","summary":"On this post I will show how to configure and use Pacserve and Powerpill on Arch Linux. On a network of several Arch Linux boxes, it is possible to configure a Master server which will hold a copy of all the installed packages within that host and keep it up to date frequently. The other hosts on the network can be configured as Slaves and they will download the packages from the Master whenever possible instead of the Internet directly.","type":"entry","url":"https://albertdelafuente.com/posts/20220109211826-configuring_pacsrv_and_powerpill_on_arch_linux/"}